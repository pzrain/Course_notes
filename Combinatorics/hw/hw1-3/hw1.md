## 第一章习题（进阶B）

<p align="right">潘子睿 2024310675</p>

> 按照要求，我对于每道题的难度进行了打分。我将打分分为两个维度，分别为**思维**和**计算**。**思维**表示拿到题目后思考得到解法的难度，**计算**表示有思路后完成计算过程的难度。我认为这些题目都很适合组合数学。$1\leq$打分$\leq 5$，分数越高代表越难。

### 1.25

> 难度：思维2，计算3

证明：

考虑$\forall i\in\set{1,2,\cdots,n}$，令$A_i=\set{A|A\in S,\min A=i}$。由于$|A|=r$，故首先有$i\leq n-r+1$。

有
$$
|A_i|=C_{n-i}^{r-1},i\leq n-r+1
$$
所以
$$
\begin{align}
\sum_{A\in S}\min A&=\sum_{i=1}^{n-r+1}i\cdot C_{n-i}^{r-1}\\
&=C_{n-1}^{r-1}+2\cdot C_{n-2}^{r-1}+\cdots+(n-r)\cdot C_{r}^{r-1}+(n-r+1)\cdot C_{r-1}^{r-1}\\
&=(C_{n-1}^{r-1}+2\cdot C_{n-2}^{r-1}+\cdots+(n-r)\cdot C_{r}^{r-1}+(n-r)\cdot C_{r-1}^{r-1})+C_{r-1}^{r-1}\\
&=(C_{n-1}^{r-1}+2\cdot C_{n-2}^{r-1}+\cdots+(n-r)\cdot(C_{r}^{r-1}+ C_{r}^{r}))+C_{r}^{r}\\
&=(C_{n-1}^{r-1}+2\cdot C_{n-2}^{r-1}+\cdots+(n-r-1)C_{r+1}^{r-1}+(n-r)\cdot C_{r+1}^r)+C_{r}^{r}\\
&=(C_{n-1}^{r-1}+2\cdot C_{n-2}^{r-1}+\cdots+(n-r-1)(C_{r+1}^{r-1}+ C_{r+1}^r))+C_{r+1}^r+C_{r}^{r}\\
&=(C_{n-1}^{r-1}+2\cdot C_{n-2}^{r-1}+\cdots+(n-r-1)C_{r+2}^r)+C_{r+1}^r+C_{r}^{r}\\
&\cdots\\
&=C_{n}^r+C_{n-1}^r+\cdots+C_{r+1}^r+C_r^r\\
&=C_{n}^r+C_{n-1}^r+\cdots+C_{r+1}^r+C_{r+1}^{r+1}\\
&=C_{n}^r+C_{n-1}^r+\cdots+C_{r+2}^{r+1}\\
&\cdots\\
&=C_{n+1}^{r+1}=
\begin{pmatrix}
n+1\\
r+1
\end{pmatrix}
\end{align}
$$
这里在推导时用到了两个恒等式：

1. $C_{r-1}^{r-1}=1=C_r^r$
2. $C_n^r=C_{n-1}^{r-1}+C_{n-1}^r$

原命题得证。

### 1.26

> 难度：思维1，计算2

原命题等价于将除dog，p，q中出现的五个字母外的其他字母插入下面四个空中：
$$
\underset{1号空隙}{\quad\_\_\quad} p \underset{2号空隙}{\quad\_\_\quad} dog \underset{3号空隙}{\quad\_\_\quad} q \underset{4号空隙}{\quad\_\_\quad}
$$
因此我们考虑将剩下的21个字母做全排列后，在其空隙（包括首尾）中插入三个隔板，共有
$$
A_{21}^{21}\cdot C_{22}^3=78680050944432537600000
$$
种排列方案数。

### 1.27

> 难度：思维2，计算2

设
$$
\underset{1号空隙}{\quad\_\_\quad} a \underset{2号空隙}{\quad\_\_\quad} b \underset{3号空隙}{\quad\_\_\quad} c \underset{4号空隙}{\quad\_\_\quad} d \underset{5号空隙}{\quad\_\_\quad} e \underset{6号空隙}{\quad\_\_\quad}
$$
所形成的六个间隙中分别有$x_i$个字母，$1\leq i\leq 6$，则有
$$
\sum_{i=1}^6x_i=95,x_1\geq 0,x_2\geq 3,x_3\geq 5,x_4\geq 7,x_5\geq 9,x_6\geq 0
$$
考虑上不定方程解的个数。令
$$
\left\{
\begin{matrix}
x_1^{'}&=x_1+1,\\
x_2^{'}&=x_2-2,\\
x_3^{'}&=x_3-4\\
x_4^{'}&=x_4-6\\
x_5^{'}&=x_5-8\\
x_6^{'}&=x_6+1\\
\end{matrix}
\right.
$$
则上不定方程可变形为
$$
\sum_{i=1}^6x_i^{'}=77,x_i\geq 1,1\leq i\leq 6
$$
由隔板法，其解的个数为$C_{76}^5$。

另一方面，将19个f,g,h,i,j做全排列的个数为
$$
\frac{A_{95}^{95}}{(A_5^5)^5}
$$
故原题总的排列方案数为：
$$
\frac{A_{95}^{95}}{(A_5^5)^5}\cdot C_{76}^5
$$

### 1.28

> 难度：思维2，计算1

证明：
考虑不定方程
$$
x_1+x_2+\cdots+x_{m+1}=n
$$
其非负整数解的个数即为$C_{n+m}^{m}=\begin{pmatrix}n+m\\m\end{pmatrix}$。

另一方面，不定方程
$$
x_1+x_2+\cdots+x_m=k
$$
的非负整数解个数为$C_{k+m-1}^{m-1}=\begin{pmatrix}k+m-1\\m-1\end{pmatrix}$。

因此，我们对（23）式中$x_{m+1}$的数值进行枚举，令$x_{m+1}=n-k$，$0\leq k\leq n$，此时
$$
x_1+x_2+\cdots+x_m=n-x_{m+1}=k
$$
统计$x_{m+1}$取不同值时不定方程（25）的解的个数，即有
$$
\begin{pmatrix}n+m\\m\end{pmatrix}=\sum_{k=0}^n\begin{pmatrix}k+m-1\\m-1\end{pmatrix}
$$

### 1.29

> 难度：思维2，计算3

-5，-4，-3，-2，-1，1，2，3，4这9个数字中，共有5个负数，4个正数。若要求取出的四个数的乘积为正数，可分为以下三种情况：
1. 取出的四个数均为正数
2. 取出的四个数中恰好有两个负数
3. 取出的四个数均为负数

#### (1)
根据上述分析，若选择的数字互不相同，则方案数为
$$
C_4^4+C_4^2C_5^2+C_5^2=71
$$

#### (2)

根据上述分析，若选择的数字允许相同，分情况进行讨论：

1. 取出的四个数均为正数，等价于不定方程
   $$
   \sum_{i=1}^4x_i=4,x_i\geq 0
   $$
   的解的个数。这是因为，我们可以设取出的四个数中1、2、3、4的个数分别为$x_i$，$1\leq i\leq 4$。因此方案数为$C_7^3=35$。

2. 取出的四个数中恰好有两个负数。取出正数的方案数为$C_4^2+4=10$，取出负数的方案数为$C_5^2+5=15$。故总方案数为25。

3. 取出的四个数全为负数，等价于不定方程
   $$
   \sum_{i=1}^5 x_i=4,x_i\geq 0
   $$
   的解的个数，为$C_8^4=70$。

因此总的方案数为
$$
35+25+70=130
$$

### 1.30

> 难度：思维2，计算2

首先考虑正整数解，有
$$
1000000=2^6\cdot 5^6
$$
设
$$
\left\{
\begin{matrix}
x=2^{u_1}5^{v_1}\\
y=2^{u_2}5^{v_2}\\
z=2^{u_3}5^{v_3}\\
\end{matrix}
\right.,
\quad
\sum_{i=1}^3u_i=6,\sum_{i=1}^3v_i=6,\quad u_i\geq 0,v_i\geq 0
$$
因此，考虑两个不定方程：
$$
\sum_{i=1}^3u_i=6,\sum_{i=1}^3v_i=6,\quad u_i\geq 0,v_i\geq 0
$$
各自的解的个数，均为$C_8^2=28$。因此正整数解的总个数为$28\times 28=784$种。

再考虑整数解，容易发现，若$(x,y,z),x>0,y>0,z>0$是原方程的一组解，则$(-x,-y,z),(-x,y,-z),(x,-y,-z)$也为原方程的解。因此原方程的整数解数目为$784*4=3136$。

### 1.31

> 难度：思维5，计算2

证明：
$$
原式\sum_{k=1}^n\frac{k\cdot P(n,k)}{n^{k+1}}=1\Longleftrightarrow\sum_{k=1}^n n^{n-k}\cdot k\cdot P(n,k)=n^{n+1}
$$

我们通过其组合意义来对这一式子进行证明。考虑有$n$种球，我们将这些球放进$n+1$个盒子中，每个盒子都必须放且只能放一个球。形式化地，设第$i$个盒子中放的球属于第$a_i$种，$1\leq a_i\leq n$，$1\leq i \leq n$，考虑$(a_1,a_2,\cdots,a_{n+1})$的不同情况的集合$S$。很明显，由于每个盒子都可以放$n$种球中的任何一种，因此$|S|=n^{n+1}$。

另一方面，我们证明
$$
|S|=\sum_{k=1}^n n^{n-k}\cdot k\cdot P(n,k)
$$
首先，有
$$
\begin{align}
T=\sum_{k=1}^n n^{n-k}\cdot k\cdot P(n,k)&=\sum_{k=1}^n T_k\\
&=\underset{k=1}{\underline{n^{n-1}\cdot P(n,1)}}+\underset{k=2}{\underline{n^{n-2}\cdot 2\cdot P(n,2)}}+\underset{k=3}{\underline{n^{n-3}\cdot 3\cdot P(n,3)}}+\cdots+\underset{k=n}{\underline{n^0\cdot n\cdot P(n,n)}}
\end{align}
$$
考虑原问题。当$a_1=a_2$时，满足题意的情况数为
$$
|S_1|=n\cdot n^{(n+1)-2}=n\cdot n^{n-1}=n^{n-1}P(n,1)=T_1
$$
当$a_1\neq a_2$，而$a_3=a_1$或$a_3=a_2$时，也即$a_1,a_2,a_3$中有两者相同，但是$a_1$和$a_2$不同，满足题意的情况数为：
$$
|S_2|=P(n,2)\cdot 2\cdot n^{n-2}=T_2
$$
一般地，设$S_k$表示$a_1,a_2,\cdots,a_k$两两不同，$a_{k+1}=a_i$，$1\leq i\leq k$的情况，$1\leq k\leq n$，则
$$
|S_k|=P(n,k)\cdot k\cdot n^{(n+1)-(k+1)}=P(n,k)\cdot k\cdot n^{n-k}=T_k
$$
而显然$\set{S_i|1\leq i\leq n}$两两不交。另一方面，根据抽屉/鸽巢原理，一定存在$i$，$1\leq i\leq n$，使得$a_{n+1}=a_i$，因此$S_n$实际上表示了$a_1,a_2,\cdots,a_{n+1}$中前$n$个两两不同的全部情况。进一步地，$S_{n-1}\cup S_n$就表示了$a_1,a_2,\cdots,a_{n+1}$中前$n-1$个两两不同的全部情况。依次类推，可以发现$S_2\cup S_3\cup\cdots\cup S_n$表示了$a_1$和$a_2$不同的全部情况。它们和$S_1$一起，表示出了所有满足题意的序列。从而
$$
S=\cup_{i=1}^n S_i
$$
因此
$$
n^{n+1}=|S|=|\cup_{i=1}^nS_i|=\sum_{i=1}^n|S_i|=\sum_{i=1}^nT_i=T
$$
原题得证。

### 1.32

> 难度：思维3，计算1

首先，考虑1，2，3，4的全排列，共有$4!=24$种。而对于每一种全排列
$$
x_1x_2x_3x_4,x_i\in\set{1,2,3,4}
$$
由于5的中介数为3，因此5的位置是确定的，一定落在$x_1$，$x_2$之间。因此，$\set{1,2,3,4,5}$的所有排列中满足5的中介数为3的排列方案数就是24。

数字6没有限制，可以插在任意位置，因此包含6的方案数为$24\times 6=144$。而与数字5同理，数字7的中介数为3，因此数字7一定被插在$\set{1,2,3,4,5,6}$的任意排列中位列第三的数字之后，从而数字7的位置是确定的。数字8同理。

综上，原题的答案为144。

### 1.33

> 难度：思维4，计算2

原题可以拆分为两个问题：首先从$m$个不同的盒子中取出$n$个互不相邻的盒子，然后将$r$个相同的小球放入这$n$个盒子中，且满足每盒至少包含$k$个球。

1. 从$m$个不同的盒子中取出$n$个互不相邻的盒子

   给原来的$m$个不同的盒子标号为$1,2,\cdots,m$，设取出的$n$个盒子的标号为$x_1,x_2,\cdots,x_n$，且$1\leq x_1<x_2<\cdots<x_n\leq m$，则$\set{x_i}$互不相邻等价于$\set{x_i-i}$互不相同。

   > 这是因为，若存在$i$，$1\leq i<n$，满足$x_i-i=x_{i+1}-{i-1}$，则有$x_{i+1}=x_i+1$，即$x_i$和$x_{i+1}$相邻。反过来，若$x_i$和$x_{i+1}$相邻，则$x_i-i=x_{i+1}-i+1$，即$x_i-i$和$x_{i+1}-i-1$相同。

   因此这等价于从$\set{1,2,\cdots,m-n}$中取出$n$个不同的数，共有$C_{m-n}^n$种方案。

2. 将$r$个相同的小球放入这$n$个盒子中，且满足每盒至少包含$k$个球

   这对应不定方程
   $$
   x_1+x_2+\cdots x_n=r,x_i\geq k,x_i\in\mathbb{N}
   $$
   的解的个数。令$x_i^{'}=x_i-(k-1)\in\mathbb{N}^{+}$，则上不定方程化为
   $$
   x_1^{'}+x_2^{'}+\cdots+x_n^{'}=r-n\cdot(k-1)=r+n-nk,x_i\in\mathbb{N}^{+}
   $$
   其解的个数为$C_{r+n-nk-1}^{n-1}$。

综上，原题中的放球方案数为$C_{m-n}^n\cdot C_{r+n-nk-1}^{n-1}$。

### 1.34

> 难度：思维3，计算3

首先，对于任意回文串，其中奇数个的字母种数不超过1。

因此，若$\set{a_i}$中中奇数个的种数超过1，则不存在符合要求的字符串数目。下分两种情况讨论：

1. $\set{a_i}$中恰好有一个为奇数，设为$a_k$，其中$1\leq k\leq 26$。则必须让字母$\tau(k)$放置在回文串的正中间，其将该回文串分成完全对称的两部分。从而我们只需考虑前半部分，其中包括$a_i/2$个字母$\tau(i)$，$1\leq i\leq 26$，$i\neq k$，以及$(a_k-1)/2$个字母$\tau(k)$。令$N_1=\frac{(\sum_{i=1}^{26}a_i)-1}{2}$表示此时字母的总数，则这些字母的全排列方案数共有
   $$
   \frac{P(N_1,N_1)}{\prod_{i=1,i\neq k}^{26}P(\frac{a_i}{2},\frac{a_i}{2})\cdot P(\frac{a_k-1}{2},\frac{a_k-1}{2})}=\frac{N_1!}{\prod_{i=1,i\neq k}^{26}(\frac{a_i}{2})!\cdot(\frac{a_k-1}{2})!}
   $$

2. $\set{a_i}$中均为偶数。此时回文串的长度为偶数，其前半部分和后半部分构成两个完全对称的序列。同样的，我们只考虑前半部分，其中包括$\frac{a_i}{2}$个字母$\tau(i)$，$1\leq i\leq 26$。令$N_2=\frac{\sum_{i=1}^{26}a_i}{2}$，则这些字母的全排列方案数共有
   $$
   \frac{P(N_2,N_2)}{\prod_{i=1}^{26}P(\frac{a_i}{2},\frac{a_i}{2})}=\frac{N_2!}{\prod_{i=1}^{26}(\frac{a_i}{2})!}
   $$

综上，设$\set{a_i}$中奇数的个数为$t$，$t\geq 0$，则符合要求的字符串数目为
$$
\left\{
\begin{matrix}
\frac{N_2!}{\prod_{i=1}^{26}(\frac{a_i}{2})!},\space &其中N_2=\frac{\sum_{i=1}^{26}a_i}{2},&t=0\\
\frac{N_1!}{\prod_{i=1,i\neq k}^{26}(\frac{a_i}{2})!\cdot(\frac{a_k-1}{2})!},\space&其中N_1=\frac{(\sum_{i=1}^{26}a_i)-1}{2},a_k为唯一的奇数,&t=1\\
0,&&t>1
\end{matrix}
\right.
$$

### 1.35

> 难度：思维4，计算2

考虑将一个三阶魔方的角块和棱块全部拆下，再随机拼回的情况总数。

首先考虑角块，三阶魔方一共有8个角块，对于每一个角，其均落在三个不同颜色中心块所在的面上，因此每个角的位置都是不同的。而每个角块有三个面，通过旋转角块可知，每个角块在某个角上的状态数为3，因此随机拼回角块的方案数为：
$$
P(8,8)\cdot 3^8=8!\cdot 3^8
$$
其次，考虑棱块，三阶魔方一共有12个棱块。对于每一条棱，其均落在两个不同颜色中心块所在的面上，因此每个棱块的位置也都是不同的。而每个棱块有两个面，通过旋转棱块可知，每个棱块在某条棱上的状态数为2，因此随机拼回棱块的方案数为：
$$
P(12,12)\cdot 2^{12}=12!\cdot 2^{12}
$$
从而三阶魔方的总状态数为$8!\cdot 3^8\cdot 12!\cdot 2^{12}$。

另一方面，随机拼回后魔方能复原的概率为$\frac{1}{12}$，因此三阶魔方的合法状态数应为总状态数的$\frac{1}{12}$，即
$$
\frac{8!\cdot 3^8\cdot 12!\cdot 2^{12}}{12}
$$

### 1.36

> 难度：思维3，计算3

#### (1)

若所有同学都回答了此题，则可能出现的统计结果数目等价于不定方程
$$
x_1+x_2+x_3+x_4=147
$$
的非负整数解个数，为$C_{150}^3=551300$。

#### (2)

若每位同学均可能没有回答此题，则可能出现的统计结果数目为一系列不定方程
$$
x_1+x_2+x_3+x_4=k,0\leq k\leq 147
$$
的非负整数解个数的和，为
$$
\begin{align}
\sum_{k=0}^{147}C_{k+3}^3&=C_3^3+C_4^3+C_5^3+\cdots+C_{150}^3\\
&=C_4^4+C_4^3+C_5^3+\cdots+C_{150}^3\\
&=C_5^4+C_5^3+\cdots+C_{150}^3\\
&=C_{151}^4=20811575
\end{align}
$$

#### (3)

原题等价于以下一系列不定方程
$$
x_1+x_2+x_3+x_4=k,0\leq k\leq 147,x_3\geq\lceil\frac{k}{2}\rceil
$$
的非负整数解的个数的和。其中$\lceil\frac{k}{2}\rceil$表示$\frac{k}{2}$的上取整。

因此，总结果数目为
$$
\begin{align}
\sum_{k=0}^{147}C_{k-\lceil\frac{k}{2}\rceil+3}^3&=\underset{k=0}{\underline{C_3^3}}+\underset{k=1}{\underline{C_3^3}}+\underset{k=2}{\underline{C_4^3}}+\underset{k=3}{\underline{C_4^3}}+\cdots+\underset{k=147}{\underline{C_{76}^3}}\\
&=2(C_3^3+C_4^3+\cdots+C_{76}^3)\\
&=2 C_{77}^4=2706550
\end{align}
$$
